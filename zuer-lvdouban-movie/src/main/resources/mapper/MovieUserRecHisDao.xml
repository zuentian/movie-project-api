<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zuer.zuerlvdoubanmovie.dao.MovieUserRecHisDao">

    <insert id="insertByMovieUserRecordAndDay" parameterType="java.lang.Object">
        <!--<bind name="borderDay" value="NOW()-day"></bind>-->
        INSERT INTO
            movie_user_rec_his
        (MOVIE_ID,USER_ID,STATE,SCORE,SHORT_COMMAND,MARK_TIME)
        SELECT
            B.MOVIE_ID,B.USER_ID,B.STATE,B.SCORE,B.SHORT_COMMAND,B.CRT_TIME
        FROM MOVIE_USER_RECORD B
        WHERE
            B.MOVIE_ID = #{movieId}
        AND B.USER_ID = #{userId}
        AND DATEDIFF(NOW(),B.CRT_TIME) &gt;= #{day}
    </insert>
</mapper>